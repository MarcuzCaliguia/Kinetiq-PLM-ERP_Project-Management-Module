{% extends 'project_reports/base.html' %}

{% block title %}Report List{% endblock %}

{% block content %}
<div class="header-container">
    <h1>Reports</h1>
    <div>
        <a href="{% url 'project_reports:report_list' %}" class="btn btn-outline-primary">Report List</a>
        <a href="{% url 'project_reports:analytics' %}" class="btn btn-outline-primary">Analytics</a>
        <a href="{% url 'project_reports:report_create' %}" class="btn btn-primary">Create Report</a>
    </div>
</div>

<form action="{% url 'project_reports:bulk_delete' %}" method="post" id="reports-form">
    {% csrf_token %}
    <div class="d-flex justify-content-between mb-3">
        <a href="javascript:history.back()" class="btn btn-outline-secondary">Back</a>
        <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete selected reports?')">Remove Report</button>
    </div>

    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead class="table-light">
                <tr>
                    <th><input type="checkbox" id="select-all"></th>
                    <th>Type Of Report</th>
                    <th>Report Title</th>
                    <th>Received From</th>
                    <th>Date Created</th>
                    <th>Assigned To</th>
                    <th>Description</th>
                    <th>Attached File</th>
                </tr>
            </thead>
            <tbody>
                {% for report in reports %}
                <tr>
                    <td><input type="checkbox" name="report_ids" value="{{ report.report_monitoring_id }}"></td>
                    <td>{{ report.report_type }}</td>
                    <td><a href="{% url 'project_reports:report_detail' report.report_monitoring_id %}">{{ report.report_title }}</a></td>
                    <td>{{ report.received_from }}</td>
                    <td>{{ report.date_created|date:"Y-m-d" }}</td>
                    <td>{{ report.assigned_to }}</td>
                    <td>{{ report.description|truncatechars:50 }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="8" class="text-center">No reports available</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</form>

{% endblock %}

{% block extra_js %}
<script>
    document.getElementById('select-all').addEventListener('change', function() {
        const checkboxes = document.querySelectorAll('input[name="report_ids"]');
        checkboxes.forEach(checkbox => {
            checkbox.checked = this.checked;
        });
    });
</script>
{% endblock %}